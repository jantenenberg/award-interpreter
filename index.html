<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fair Work Award Calculator – Rates Explorer (Phase 1)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./styles.css" />
    <!-- PapaParse for robust CSV parsing -->
    <script
      src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"
      crossorigin="anonymous"
    ></script>
    <script type="module" src="./src/data-loader.js?v=20250218"></script>
    <script type="module" src="./src/dropdown-manager.js?v=20250218"></script>
    <script type="module" src="./src/rate-display.js?v=20250218"></script>
    <script type="module" src="./src/shift-cost-calculator.js?v=20260226"></script>
    <script type="module" src="./src/resource-cost-calculator.js?v=20260226"></script>
    <script type="module" src="./src/roster-cost-calculator.js?v=20260226"></script>
  </head>
  <body>
    <div class="app-container" role="application" aria-label="Maica Roster Costing Calculator">
      <header class="app-header">
        <div class="app-header-inner">
          <div class="app-brand">
            <img
              src="./assets/maica-logo.png"
              alt="Maica logo"
              class="app-logo"
            />
            <div class="app-brand-text">
              <h1>Maica Roster Costing Calculator</h1>
              <p>Calculate indicative roster costs based on currently available award data.</p>
            </div>
          </div>
          <nav class="app-nav">
            <a href="./index.html" class="active">Calculator</a>
            <a href="./config.html">Configuration</a>
            <a href="./documentation.html">Documentation</a>
            <a href="./reference-data.html">Reference Data</a>
          </nav>
        </div>
      </header>

      <main class="app-content">
        <!-- Global loading + status -->
        <section class="section" aria-live="polite">
          <div class="section-header">
            <div class="section-title">
              <span class="section-title-dot"></span>
              <span>Data loading status</span>
            </div>
          </div>
          <div id="fw-loading-row" class="loading-row">
            <div class="spinner" aria-hidden="true"></div>
            <div>
              <div id="fw-loading-text" class="status-loading">
                Connecting to Fair Work data tables…
              </div>
              <div id="fw-loading-detail" class="help-text">
                Loading awards, classifications, penalties, wage allowances and expense allowances from the database.
              </div>
            </div>
          </div>
        </section>

        <!-- Resource Profile Calculator: combines award, classification, and rates -->
        <section class="section" aria-labelledby="section-resource-profile-heading">
          <details class="section-details">
            <summary class="section-summary">
              <div class="section-header">
                <div class="section-title">
                  <span class="section-title-dot"></span>
                  <span id="section-resource-profile-heading">Resource Profile Calculator</span>
                </div>
              </div>
            </summary>
            <div class="section-body">

          <!-- Subsection 1: Award & employment type -->
          <details class="collapsible-details">
            <summary class="collapsible-summary" id="section-award-heading">
              <span class="section-title">
                <span class="section-title-dot"></span>
                <span>Award & employment type</span>
              </span>
              <span class="pill" id="badge-awards-count">
                <span class="badge-dot"></span>
                <span>Loading awards…</span>
              </span>
            </summary>
            <div class="collapsible-content">
              <div class="form-grid">
                <!-- Award dropdown (search + select) -->
                <div class="form-group">
                  <div class="form-label-row">
                    <label for="awardSearch">
                      Award
                      <span class="required" aria-hidden="true">*</span>
                    </label>
                    <span id="award-options-count" class="options-count">(0 options)</span>
                  </div>
                  <input
                    id="awardSearch"
                    class="form-control"
                    type="search"
                    placeholder="Type to search 155+ awards"
                    autocomplete="off"
                    aria-describedby="award-search-help"
                    disabled
                  />
                  <span id="award-search-help" class="help-text">
                    Start typing an award code or name to filter.
                  </span>
                  <select
                    id="awardSelect"
                    class="form-select"
                    size="8"
                    aria-label="Award code"
                    disabled
                  >
                    <option value="">Loading awards…</option>
                  </select>
                </div>

                <!-- Employee rate type -->
                <div class="form-group">
                  <div class="form-label-row">
                    <label for="rateTypeSelect">
                      Employee rate type
                      <span class="required" aria-hidden="true">*</span>
                    </label>
                    <span id="rate-type-options-count" class="options-count">(9 options)</span>
                  </div>
                  <select
                    id="rateTypeSelect"
                    class="form-select"
                    aria-describedby="rate-type-help"
                    disabled
                  >
                    <option value="">Select employment type</option>
                    <option value="AD">AD – Adult</option>
                    <option value="FT">FT – Full-time</option>
                    <option value="PT">PT – Part-time</option>
                    <option value="CA">CA – Casual</option>
                    <option value="JR">JR – Junior</option>
                    <option value="AP">AP – Apprentice</option>
                    <option value="TR">TR – Trainee</option>
                    <option value="DI">DI – Disability</option>
                    <option value="SL">SL – School-based</option>
                  </select>
                  <span id="rate-type-help" class="help-text">
                    Classifications are filtered by this code; adult (AD) classifications are also included where applicable.
                  </span>
                </div>

                <!-- Casual loading percentage (used when converting weekly base to hourly for CA) -->
                <div class="form-group">
                  <div class="form-label-row">
                    <label for="casualLoadingPercent">Casual loading %</label>
                  </div>
                  <input
                    id="casualLoadingPercent"
                    class="form-control"
                    type="number"
                    min="0"
                    max="100"
                    step="0.5"
                    value="25"
                    placeholder="25"
                    aria-describedby="casual-loading-help"
                  />
                  <span id="casual-loading-help" class="help-text">
                    Applied when weekly base rate is converted to hourly for casual (CA) employees. Default 25%. Only affects calculations when calculated rate is missing and base is weekly.
                  </span>
                </div>

                <!-- State / Territory -->
                <div class="form-group">
                  <div class="form-label-row">
                    <label for="stateSelect">
                      State / territory
                      <span class="required" aria-hidden="true">*</span>
                    </label>
                  </div>
                  <select
                    id="stateSelect"
                    class="form-select"
                    aria-label="State or territory"
                  >
                    <option value="">Select state</option>
                    <option value="NSW">NSW – New South Wales</option>
                    <option value="VIC">VIC – Victoria</option>
                    <option value="QLD">QLD – Queensland</option>
                    <option value="WA">WA – Western Australia</option>
                    <option value="SA">SA – South Australia</option>
                    <option value="TAS">TAS – Tasmania</option>
                    <option value="ACT">ACT – Australian Capital Territory</option>
                    <option value="NT">NT – Northern Territory</option>
                  </select>
                  <span class="help-text">Used later for public holiday logic (not applied in Phase 1).</span>
                </div>

                <!-- Published year -->
                <div class="form-group">
                  <div class="form-label-row">
                    <label for="yearSelect">Published year</label>
                  </div>
                  <select
                    id="yearSelect"
                    class="form-select"
                    aria-label="Published year"
                  >
                    <option value="2025" selected>2025</option>
                    <option value="2024">2024</option>
                    <option value="2023">2023</option>
                  </select>
                  <span class="help-text">
                    Filters to rows where the award/classification is operative for the current date.
                  </span>
                </div>
              </div>
            </div>
          </details>

          <!-- Subsection 2: Classification -->
          <details class="collapsible-details">
            <summary class="collapsible-summary" id="section-classification-heading">
              <span class="section-title">
                <span class="section-title-dot"></span>
                <span>Classification</span>
              </span>
              <span class="pill" id="badge-classifications-count">
                <span class="badge-dot"></span>
                <span>No award selected</span>
              </span>
            </summary>
            <div class="collapsible-content">
              <div class="form-grid">
                <!-- Classification dropdown -->
                <div class="form-group">
                  <div class="form-label-row">
                    <label for="classificationSelect">
                      Classification
                      <span class="required" aria-hidden="true">*</span>
                    </label>
                    <span id="classification-options-count" class="options-count">(0 options)</span>
                  </div>
                  <select
                    id="classificationSelect"
                    class="form-select"
                    disabled
                    aria-describedby="classification-help"
                  >
                    <option value="">Select award and rate type first</option>
                  </select>
                  <span id="classification-help" class="help-text">
                    Populated after you choose an award and employee rate type.
                  </span>
                </div>

                <!-- Auto-populated metadata fields -->
                <div class="form-group">
                  <label for="awardFixedId">Award fixed ID</label>
                  <input
                    id="awardFixedId"
                    class="form-control"
                    type="text"
                    readonly
                    aria-readonly="true"
                  />
                  <span class="help-text muted">From `mapawardexport2025.csv`.</span>
                </div>

                <div class="form-group">
                  <label for="classificationFixedId">Classification fixed ID</label>
                  <input
                    id="classificationFixedId"
                    class="form-control"
                    type="text"
                    readonly
                    aria-readonly="true"
                  />
                  <span class="help-text muted">From `mapclassificationexport2025.csv`.</span>
                </div>

                <div class="form-group">
                  <label for="classificationLevel">Classification level</label>
                  <input
                    id="classificationLevel"
                    class="form-control"
                    type="text"
                    readonly
                    aria-readonly="true"
                  />
                </div>

                <div class="form-group">
                  <label for="parentClassificationName">Parent classification name</label>
                  <input
                    id="parentClassificationName"
                    class="form-control"
                    type="text"
                    readonly
                    aria-readonly="true"
                  />
                </div>

                <div class="form-group">
                  <label for="baseRateField">Base rate ($/hour)</label>
                  <input
                    id="baseRateField"
                    class="form-control"
                    type="text"
                    readonly
                    aria-readonly="true"
                  />
                </div>

                <div class="form-group">
                  <label for="calculatedRateField">Calculated rate ($/hour)</label>
                  <input
                    id="calculatedRateField"
                    class="form-control"
                    type="text"
                    readonly
                    aria-readonly="true"
                  />
                </div>

                <div class="form-group">
                  <label for="baseRateTypeField">Base rate type</label>
                  <input
                    id="baseRateTypeField"
                    class="form-control"
                    type="text"
                    readonly
                    aria-readonly="true"
                  />
                </div>

                <div class="form-group">
                  <label for="calculatedRateTypeField">Calculated rate type</label>
                  <input
                    id="calculatedRateTypeField"
                    class="form-control"
                    type="text"
                    readonly
                    aria-readonly="true"
                  />
                </div>
              </div>
            </div>
          </details>

          <!-- Subsection 3: Base and penalty rates -->
          <details class="collapsible-details">
            <summary class="collapsible-summary" id="section-rates-heading">
              <span class="section-title">
                <span class="section-title-dot"></span>
                <span>Base and penalty rates</span>
              </span>
            </summary>
            <div class="collapsible-content">
              <div class="form-grid">
                <!-- Base rate panel -->
                <div class="form-group">
                  <div class="rate-panel" id="baseRatePanel" aria-live="polite">
                    <div class="rate-panel-header">
                      <div class="rate-panel-title">Selected classification</div>
                      <div id="baseRateEmploymentType" class="pill pill-casual" hidden></div>
                    </div>
                    <div id="baseRateBody" class="rate-panel-body">
                      <div class="empty-state" id="baseRateEmpty">
                        Choose an award, rate type, and classification to see base rate details.
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Applicable penalty rates (separate section, collapsed by default) -->
              <details class="collapsible-details" id="penaltiesDetails">
                <summary class="collapsible-summary" id="section-penalties-heading">
                  <span class="section-title">
                    <span class="section-title-dot"></span>
                    <span>Applicable penalty rates</span>
                  </span>
                  <span class="pill" id="penaltiesSummary">No classification selected</span>
                </summary>
                <div class="collapsible-content">
                  <div id="penaltiesContainer" aria-live="polite">
                    <div class="empty-state">
                      Penalty rates for the chosen classification will appear here, filtered by
                      <span class="tooltip" aria-label="Award code, classification name/level, employee rate type (including Adult AD as wildcard).">
                        award, classification, and rate type
                      </span>.
                    </div>
                  </div>
                </div>
              </details>
            </div>
          </details>

          </div>
          </details>
        </section>

        <!-- Calculator 2: Shift Cost -->
        <section class="section" aria-labelledby="section-shift-cost-heading">
          <details class="section-details">
            <summary class="section-summary">
              <div class="section-header">
                <div class="section-title">
                  <span class="section-title-dot"></span>
                  <span id="section-shift-cost-heading">Shift Cost Calculator</span>
                </div>
                <div class="section-meta">
                  <span class="section-hint">One shift · multiple resources · cost per resource and shift total</span>
                </div>
              </div>
            </summary>
            <div class="section-body">
          <!-- Shift details -->
          <details class="collapsible-details subsection-collapsible">
            <summary class="collapsible-summary subsection-summary">Shift details</summary>
            <div class="collapsible-content">
          <div class="shift-cost-shift-details">
            <div class="form-row">
              <div class="form-group">
                <label class="form-label" for="scShiftDate">Date</label>
                <input type="date" id="scShiftDate" class="form-control" />
              </div>
              <div class="form-group">
                <label class="form-label" for="scShiftStart">Start time</label>
                <input type="time" id="scShiftStart" class="form-control" value="09:00" />
              </div>
              <div class="form-group">
                <label class="form-label" for="scShiftDuration">Duration (hrs)</label>
                <input type="number" id="scShiftDuration" class="form-control"
                       value="8" min="0.5" step="0.5" />
              </div>
              <div class="form-group">
                <label class="form-label" for="scShiftBreak">Break (min)</label>
                <input type="number" id="scShiftBreak" class="form-control"
                       value="30" min="0" step="5" />
              </div>
              <div class="form-group form-group-checkbox">
                <label class="form-label checkbox-label">
                  <input type="checkbox" id="scPublicHoliday" />
                  Public holiday
                </label>
              </div>
            </div>
          </div>
            </div>
          </details>

          <!-- Resources -->
          <details class="collapsible-details subsection-collapsible">
            <summary class="collapsible-summary subsection-summary">Resources on this shift</summary>
            <div class="collapsible-content">
            <div class="shift-cost-resources-header">
            <span class="subsection-label">Resources on this shift</span>
            <button class="btn btn-secondary" id="scAddResource" type="button">
              + Add Resource
            </button>
          </div>
          <div id="scResources"></div>
            </div>
          </details>

          <!-- Calculate -->
          <div class="shift-cost-actions">
            <button class="btn btn-primary" id="scCalculate" type="button">
              Calculate Shift Cost
            </button>
          </div>

          <!-- Result -->
          <div id="scResult" class="rate-panel" aria-live="polite" hidden></div>

          </div>
          </details>
        </section>

        <!-- Calculator 3: Resource Cost Calculator -->
        <section class="section" aria-labelledby="section-resource-cost-heading">
          <details class="section-details">
            <summary class="section-summary">
              <div class="section-header">
                <div class="section-title">
                  <span class="section-title-dot"></span>
                  <span id="section-resource-cost-heading">Resource Cost Calculator</span>
                </div>
                <div class="section-meta">
                  <span class="section-hint">One resource · multiple shifts · cost per shift and resource total</span>
                </div>
              </div>
            </summary>
            <div class="section-body">
          <details class="collapsible-details subsection-collapsible">
            <summary class="collapsible-summary subsection-summary">Resource details</summary>
            <div class="collapsible-content">
          <div class="resource-row">
            <div class="resource-row-header">
              <span class="resource-row-number">Resource Details</span>
            </div>
            <div class="resource-row-body">

              <div class="resource-field-group">
                <label class="field-label">Name</label>
                <input type="text" id="rccName" class="form-control" placeholder="Resource name" />
              </div>

              <div class="resource-field-group">
                <label class="field-label">
                  Award
                  <span id="rccAwardCount" class="badge-count">(0 options)</span>
                </label>
                <input
                  type="text"
                  id="rccAwardSearch"
                  class="form-control"
                  placeholder="Type to search awards…"
                  autocomplete="off"
                />
                <p class="field-help">Start typing an award code or name to filter.</p>
                <select id="rccAward" class="form-select" size="5">
                  <option value="">Select award</option>
                </select>
              </div>

              <div class="resource-field-group">
                <label class="field-label">
                  Employee rate type
                  <span class="badge-count">(4 options)</span>
                </label>
                <select id="rccRateType" class="form-select">
                  <option value="">Select employment type</option>
                  <option value="CA">CA – Casual</option>
                  <option value="FT">FT – Full-time</option>
                  <option value="PT">PT – Part-time</option>
                  <option value="AD">AD – Adult</option>
                </select>
                <p class="field-help">Classifications are filtered by this code; adult (AD) classifications are also included where applicable.</p>
                <div class="rc-loading-group" id="rccLoadingGroup" hidden>
                  <label class="field-label">Casual loading %</label>
                  <input
                    type="number"
                    id="rccLoading"
                    class="form-control"
                    value="25"
                    min="0"
                    max="100"
                    step="1"
                  />
                  <p class="field-help">Applied when weekly base rate is converted to hourly for casual (CA) employees. Default 25%.</p>
                </div>
              </div>

              <div class="resource-field-group">
                <label class="field-label">
                  Classification
                  <span id="rccClassCount" class="badge-count">(0 options)</span>
                </label>
                <select id="rccClassification" class="form-select" disabled>
                  <option value="">Select award and rate type first</option>
                </select>
                <p class="field-help">Populated after you choose an award and employee rate type.</p>
                <label class="field-label">Wage allowances</label>
                <select id="rccWageAllowances" class="form-select" multiple size="4" disabled>
                  <option value="">Select award first</option>
                </select>
                <label class="field-label">Expense allowances</label>
                <select id="rccExpenseAllowances" class="form-select" multiple size="4" disabled>
                  <option value="">Select award first</option>
                </select>
              </div>

            </div>
          </div>
            </div>
          </details>

          <details class="collapsible-details subsection-collapsible">
            <summary class="collapsible-summary subsection-summary">Shifts</summary>
            <div class="collapsible-content">
          <div class="rcc-shifts-header">
            <span class="subsection-label">Shifts</span>
            <button class="btn btn-secondary" id="rccAddShift" type="button">+ Add Shift</button>
          </div>
          <div id="rccShifts"></div>
            </div>
          </details>

          <div class="shift-cost-actions">
            <button class="btn btn-primary" id="rccCalculate" type="button">Calculate Resource Cost</button>
          </div>

          <div id="rccResult" class="rate-panel" aria-live="polite" hidden></div>

          </div>
          </details>
        </section>

        <!-- Calculator 4: Roster Cost Calculator -->
        <section class="section rc4-section" aria-labelledby="section-roster-cost-heading">
          <details class="section-details">
            <summary class="section-summary">
              <div class="section-header">
                <div class="section-title">
                  <span class="section-title-dot"></span>
                  <span id="section-roster-cost-heading">Roster Cost Calculator</span>
                </div>
                <div class="section-meta">
                  <span class="section-hint">Multiple shifts · multiple resources per shift · cost at every level</span>
                </div>
              </div>
            </summary>
            <div class="section-body">
          <div class="rc4-section-body">
          <!-- Roster name -->
          <div class="rc4-name-row">
            <label class="field-label" for="rc4RosterName">Roster name</label>
            <input type="text" id="rc4RosterName" class="form-input"
                   placeholder="e.g. Week ending 28 Feb 2026" />
          </div>

          <!-- Shifts -->
          <details class="collapsible-details subsection-collapsible">
            <summary class="collapsible-summary subsection-summary">Shifts</summary>
            <div class="collapsible-content">
            <div class="rc4-shifts-header">
            <span class="subsection-label">Shifts</span>
            <button class="btn btn-secondary" id="rc4AddShift" type="button">+ Add Shift</button>
          </div>
          <div id="rc4Shifts"></div>
            </div>
          </details>

          <!-- Calculate -->
          <div class="shift-cost-actions">
            <button class="btn btn-primary" id="rc4Calculate" type="button">
              Calculate Roster Cost
            </button>
          </div>

          <!-- Result -->
          <div id="rc4Result" class="rate-panel" aria-live="polite" hidden></div>

          </div>
            </div>
          </details>
        </section>

      </main>
    </div>
  </body>
</html>

